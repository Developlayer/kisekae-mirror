<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KisekaeMirror - 着せ替え体験アプリ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
    <!-- ヘッダー -->
    <header>
      <h1>KisekaeMirror</h1>
      <p>着せ替え体験アプリ</p>
    </header>

    <!-- メインコンテンツ -->
    <main>
      <!-- 左側エリア（カメラ + 表示設定） -->
      <div id="left-area">
        <!-- カメラ映像エリア -->
        <div id="camera-container">
          <video id="camera-video" autoplay playsinline></video>
          <canvas id="output-canvas"></canvas>
        </div>

        <!-- 表示設定 -->
        <section id="debug-section">
          <h2>表示設定</h2>
          <label id="debug-toggle">
            <input type="checkbox" id="debug-mode">
            デバッグモード（骨格を表示）
          </label>
        </section>
      </div>

      <!-- コントロールパネル -->
      <aside id="control-panel">
        <section id="upload-section">
          <h2>服の画像を読み込む</h2>

          <!-- ドラッグ&ドロップエリア -->
          <div id="drop-zone">
            <p>ここに画像をドラッグ&ドロップ</p>
            <p>または</p>
            <input type="file" id="file-input" accept="image/*" style="display: none;">
            <button id="file-button">画像を選択</button>
          </div>

          <!-- トリミング編集画面 -->
          <div id="trim-section" style="display: none;">
            <h3>トリミング範囲を選択</h3>
            <div id="trim-container">
              <canvas id="trim-canvas"></canvas>
            </div>
            <div id="trim-controls">
              <button id="trim-reset">リセット</button>
              <button id="trim-confirm">トリミング確定</button>
              <button id="trim-skip">スキップ（トリミングなし）</button>
            </div>
            <p style="font-size: 12px; color: #666;">四隅や辺のハンドルをドラッグしてトリミング範囲を調整してください</p>
          </div>

          <!-- 服の分類選択 -->
          <div id="category-selection" style="display: none;">
            <h3>服の種類を選択:</h3>
            <label><input type="radio" name="category" value="upper"> 上半身（シャツ、ジャケットなど）</label>
            <label><input type="radio" name="category" value="lower"> 下半身（ズボン、スカートなど）</label>
            <label><input type="radio" name="category" value="full"> 全身（ドレス、つなぎなど）</label>
            <button id="category-confirm">確定</button>
          </div>
        </section>

        <!-- サイズ調整 -->
        <section id="size-adjust-section" style="display: none;">
          <h2>サイズ調整</h2>

          <!-- タブ切り替え -->
          <div id="size-adjust-tabs">
            <button class="size-tab" data-category="upper">上半身</button>
            <button class="size-tab" data-category="lower">下半身</button>
            <button class="size-tab" data-category="full">全身</button>
          </div>

          <!-- 縦横比固定チェックボックス -->
          <div style="margin-bottom: 6px; margin-top: 6px;">
            <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.75rem;">
              <input type="checkbox" id="lock-aspect-ratio" checked style="margin-right: 5px;">
              縦横比を固定
            </label>
          </div>

          <div id="size-controls">
            <!-- 全体スケール（縦横比固定時） -->
            <div id="unified-scale-control" class="size-control">
              <label for="unified-scale">大きさ: <span id="unified-value">100%</span></label>
              <input type="range" id="unified-scale" min="50" max="200" value="100" step="5">
            </div>

            <!-- 個別スケール（縦横比固定解除時） -->
            <div id="individual-scale-controls" style="display: none;">
              <div class="size-control">
                <label for="width-scale">横幅: <span id="width-value">100%</span></label>
                <input type="range" id="width-scale" min="50" max="200" value="100" step="5">
              </div>
              <div class="size-control">
                <label for="height-scale">縦幅: <span id="height-value">100%</span></label>
                <input type="range" id="height-scale" min="50" max="200" value="100" step="5">
              </div>
            </div>

            <button id="reset-size">リセット</button>
          </div>
        </section>

        <!-- 重ね順設定 -->
        <section id="layer-order-section">
          <h2>重ね順設定</h2>
          <div id="layer-order-controls">
            <label>
              <input type="radio" name="layer-order" value="upper-on-top" checked>
              上半身を上に
            </label>
            <label>
              <input type="radio" name="layer-order" value="lower-on-top">
              下半身を上に
            </label>
          </div>
        </section>

        <!-- 読み込んだ服のリスト -->
        <section id="clothes-list">
          <h2>読み込んだ服</h2>
          <div id="upper-clothes">
            <h3>上半身</h3>
            <div class="clothes-items"></div>
          </div>
          <div id="lower-clothes">
            <h3>下半身</h3>
            <div class="clothes-items"></div>
          </div>
          <div id="full-clothes">
            <h3>全身</h3>
            <div class="clothes-items"></div>
          </div>
        </section>
      </aside>
    </main>

    <!-- ステータス表示 -->
    <div id="status">
      <p id="status-text">カメラを起動中...</p>
    </div>
  </div>

  <!-- メインスクリプト -->
  <script type="module" src="/main.js"></script>

  <!-- MediaPipe CDN (現在は使用しない) -->
  <!--
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
  -->
</body>
</html>
